{"version":3,"sources":["js/orglist.js"],"names":["$","reloadTable","prop","table","tableEl","DataTable","language","myApp","datatablesLang","destroy","paging","pageLength","lengthChange","searching","ordering","info","autoWidth","serverSide","ajax","data","callback","settings","type","cache","url","success","res","result","parseJSON","code","columns","class","orderable","defaultContent","on","this","is","allChecked","length","len","alert","hide","modal","array","each","row","parents","push","orgId","traditional","orgIds","text","show"],"mappings":"AACAA,EAAE,WAKE,QAASC,KAELD,EAAE,0CAA0CE,KAAK,WAAW,GAE5DC,EAAQC,EAAQC,WACZC,SAAUC,MAAMC,eAChBC,SAAW,EACXC,QAAU,EACVC,WAAc,GACdC,cAAgB,EAChBC,WAAa,EACbC,UAAY,EACZC,MAAQ,EACRC,WAAa,EACbC,YAAc,EACdC,KAAQ,SAAUC,EAAMC,EAAUC,GAE9BrB,EAAEkB,MACEI,KAAM,OACNC,OAAO,EACPJ,KAAMA,EACNK,IAAK,OACLC,QAAS,SAAUC,GACf,GAAIC,GAAS3B,EAAE4B,UAAUF,EACN,IAAfC,EAAOE,MACPT,EAASO,OAKzBG,UAEQC,QAAS,cACTC,WAAa,EACbb,KAAQ,KACRc,eAAkB,8CAErBd,KAAQ,UACRA,KAAQ,SACRA,KAAQ,cA1CrB,GACIhB,GADAC,EAAUJ,EAAE,aA+ChBC,KAEAG,EAAQ8B,GAAG,SAAU,yCAA0C,WAC3DlC,EAAE,2CAA2CE,KAAK,UAAWF,EAAEmC,MAAMC,GAAG,eAE5EhC,EAAQ8B,GAAG,SAAU,0CAA2C,WAC5D,GAAIG,GAAmF,IAAtErC,EAAE,yDAAyDsC,MAC5EtC,GAAE,0CAA0CE,KAAK,UAAWmC,KAGhErC,EAAE,cAAckC,GAAG,QAAS,WACxB,GAAIK,GAAMvC,EAAE,mDAAmDsC,MAC/D,OAAW,IAAPC,MACAC,OAAM,UAGNxC,EAAE,gCAAgCyC,OAClCzC,EAAE,+BAA+ByC,OACjCzC,EAAE,iBAAiB0C,QAFnB1C,UAKRA,EAAE,mCAAmCkC,GAAG,QAAS,WAC7C,GAAIS,KACJ3C,GAAE,mDAAmD4C,KAAK,WACtD,GAAIzB,GAAOhB,EAAM0C,IAAI7C,EAAEmC,MAAMW,QAAQ,OAAO3B,MAC5CwB,GAAMI,KAAK5B,EAAK6B,SAEhBL,EAAML,OAAS,GACftC,EAAEkB,MACEI,KAAM,OACNC,OAAO,EACP0B,aAAa,EACb9B,MACI+B,OAAQP,GAEZnB,IAAK,SACLC,QAAS,SAAUC,GACf,GAAIC,GAAS3B,EAAE4B,UAAUF,EACN,IAAfC,EAAOE,MACP7B,EAAE,gCAAgCmD,KAAK,QACvCnD,EAAE,gCAAgCoD,OAElCnD,MAEAD,EAAE,+BAA+BmD,KAAK,QACtCnD,EAAE,+BAA+BoD","file":"orglist-ed2778cc68.js","sourcesContent":["\r\n$(function () {\r\n\r\n    var tableEl = $('#org-table');\r\n    var table;\r\n\r\n    function reloadTable() {\r\n\r\n        $(\"input[type='checkbox'][name='chk_all']\").prop(\"checked\", false);\r\n\r\n        table = tableEl.DataTable({\r\n            language: myApp.datatablesLang,\r\n            \"destroy\": true,\r\n            \"paging\": true,\r\n            \"pageLength\": 20,\r\n            \"lengthChange\": false,\r\n            \"searching\": false,\r\n            \"ordering\": false,\r\n            \"info\": true,\r\n            \"autoWidth\": false,\r\n            \"serverSide\": true,\r\n            \"ajax\": function (data, callback, settings) {\r\n\r\n                $.ajax({\r\n                    type: \"post\",\r\n                    cache: false,\r\n                    data: data,\r\n                    url: \"list\",\r\n                    success: function (res) {\r\n                        var result = $.parseJSON(res);\r\n                        if (result.code == 0) {\r\n                            callback(result);\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n            \"columns\": [\r\n                {\r\n                    \"class\": 'td-checkbox',\r\n                    \"orderable\": false,\r\n                    \"data\": null,\r\n                    \"defaultContent\": '<input type=\"checkbox\" name=\"chk_item\"\"/>'\r\n                },\r\n                {\"data\": \"orgId\"},\r\n                {\"data\": \"area\"},\r\n                {\"data\": \"orgName\"}\r\n            ]\r\n        });\r\n    }\r\n\r\n    reloadTable();\r\n\r\n    tableEl.on(\"change\", \"input[type='checkbox'][name='chk_all']\", function () {\r\n        $(\"input[type='checkbox'][name='chk_item']\").prop(\"checked\", $(this).is(':checked'));\r\n    });\r\n    tableEl.on(\"change\", \"input[type='checkbox'][name='chk_item']\", function () {\r\n        var allChecked = $(\"input[type='checkbox'][name='chk_item']:not(:checked)\").length === 0;\r\n        $(\"input[type='checkbox'][name='chk_all']\").prop(\"checked\", allChecked);\r\n    });\r\n\r\n    $('#deleteOrg').on('click', function () {\r\n        var len = $(\"input[type='checkbox'][name='chk_item']:checked\").length;\r\n        if (len == 0) {\r\n            alert(\"请选择机构\");\r\n            return;\r\n        } else {\r\n            $('#delete-modal .alert-success').hide();\r\n            $('#delete-modal .alert-danger').hide();\r\n            $('#delete-modal').modal();\r\n        }\r\n    });\r\n    $('#delete-modal button.btn-danger').on('click', function () {\r\n        var array = [];\r\n        $(\"input[type='checkbox'][name='chk_item']:checked\").each(function () {\r\n            var data = table.row($(this).parents('tr')).data();\r\n            array.push(data.orgId);\r\n        });\r\n        if (array.length > 0) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                cache: false,\r\n                traditional: true,\r\n                data: {\r\n                    orgIds: array\r\n                },\r\n                url: \"delete\",\r\n                success: function (res) {\r\n                    var result = $.parseJSON(res);\r\n                    if (result.code == 0) {\r\n                        $('#delete-modal .alert-success').text(\"删除成功\");\r\n                        $('#delete-modal .alert-success').show();\r\n\r\n                        reloadTable();\r\n                    } else {\r\n                        $('#delete-modal .alert-danger').text(\"删除失败\");\r\n                        $('#delete-modal .alert-danger').show();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n});"]}