{"version":3,"sources":["js/userlist.js"],"names":["$","reloadTable","prop","table","tableEl","DataTable","language","myApp","datatablesLang","destroy","paging","lengthChange","searching","ordering","info","autoWidth","serverSide","ajax","data","callback","settings","type","cache","url","success","res","result","parseJSON","code","columns","class","orderable","defaultContent","render","full","meta","bankName","on","this","is","allChecked","length","len","alert","hide","modal","checkboxs","row","parents","userId","text","show","array","each","push","traditional","userIds"],"mappings":"AAAAA,EAAE,WAKE,QAASC,KAELD,EAAE,0CAA0CE,KAAK,WAAW,GAE5DC,EAAQC,EAAQC,WACZC,SAAUC,MAAMC,eAChBC,SAAW,EACXC,QAAU,EACVC,cAAgB,EAChBC,WAAa,EACbC,UAAY,EACZC,MAAQ,EACRC,WAAa,EACbC,YAAc,EACdC,KAAQ,SAAUC,EAAMC,EAAUC,GAE9BpB,EAAEiB,MACEI,KAAM,OACNC,OAAO,EACPJ,KAAMA,EACNK,IAAK,OACLC,QAAS,SAAUC,GACf,GAAIC,GAAS1B,EAAE2B,UAAUF,EACN,IAAfC,EAAOE,MACPT,EAASO,OAKzBG,UAEQC,QAAS,cACTC,WAAa,EACbb,KAAQ,KACRc,eAAkB,8CAErBd,KAAQ,WACRA,KAAQ,SACRA,KAAQ,aAELA,KAAQ,OACRe,OAAU,SAAUf,EAAMG,EAAMa,EAAMC,GAClC,MAAOjB,GAAOA,EAAKkB,SAAW,MAGrClB,KAAQ,aACRA,KAAQ,iBAjDrB,GACIf,GADAC,EAAUJ,EAAE,cAsDhBC,KAEAG,EAAQiC,GAAG,SAAU,yCAA0C,WAC3DrC,EAAE,2CAA2CE,KAAK,UAAWF,EAAEsC,MAAMC,GAAG,eAE5EnC,EAAQiC,GAAG,SAAU,0CAA2C,WAC5D,GAAIG,GAAmF,IAAtExC,EAAE,yDAAyDyC,MAC5EzC,GAAE,0CAA0CE,KAAK,UAAWsC,KAKhExC,EAAE,cAAcqC,GAAG,QAAS,WACxB,GAAIK,GAAM1C,EAAE,mDAAmDyC,MAC/D,OAAW,IAAPC,MACAC,OAAM,SAECD,EAAM,MACbC,OAAM,YAGN3C,EAAE,+BAA+B4C,OACjC5C,EAAE,8BAA8B4C,OAChC5C,EAAE,gBAAgB6C,QAFlB7C,UAKRA,EAAE,mCAAmCqC,GAAG,QAAS,WAC7C,GAAIS,GAAY9C,EAAE,kDAClB,IAAwB,GAApB8C,EAAUL,OAAa,CACvB,GAAIvB,GAAOf,EAAM4C,IAAID,EAAUE,QAAQ,OAAO9B,MAC9ClB,GAAEiB,MACEI,KAAM,OACNC,OAAO,EACPJ,MACI+B,OAAQ/B,EAAK+B,QAEjB1B,IAAK,WACLC,QAAS,SAAUC,GACf,GAAIC,GAAS1B,EAAE2B,UAAUF,EACN,IAAfC,EAAOE,MACP5B,EAAE,+BAA+BkD,KAAK,QACtClD,EAAE,+BAA+BmD,OAEjClD,MAEAD,EAAE,8BAA8BkD,KAAK,QACrClD,EAAE,8BAA8BmD,cAQpDnD,EAAE,eAAeqC,GAAG,QAAS,WACzB,GAAIK,GAAM1C,EAAE,mDAAmDyC,MAC/D,OAAW,IAAPC,MACAC,OAAM,UAGN3C,EAAE,gCAAgC4C,OAClC5C,EAAE,+BAA+B4C,OACjC5C,EAAE,iBAAiB6C,QAFnB7C,UAKRA,EAAE,mCAAmCqC,GAAG,QAAS,WAC7C,GAAIe,KACJpD,GAAE,mDAAmDqD,KAAK,WACtD,GAAInC,GAAOf,EAAM4C,IAAI/C,EAAEsC,MAAMU,QAAQ,OAAO9B,MAC5CkC,GAAME,KAAKpC,EAAK+B,UAEhBG,EAAMX,OAAS,GACfzC,EAAEiB,MACEI,KAAM,OACNC,OAAO,EACPiC,aAAa,EACbrC,MACIsC,QAASJ,GAEb7B,IAAK,SACLC,QAAS,SAAUC,GACf,GAAIC,GAAS1B,EAAE2B,UAAUF,EACN,IAAfC,EAAOE,MACP5B,EAAE,gCAAgCkD,KAAK,QACvClD,EAAE,gCAAgCmD,OAElClD,MAEAD,EAAE,+BAA+BkD,KAAK,QACtClD,EAAE,+BAA+BmD","file":"userlist-c54942ecc1.js","sourcesContent":["$(function () {\r\n\r\n    var tableEl = $('#user-table');\r\n    var table;\r\n\r\n    function reloadTable() {\r\n\r\n        $(\"input[type='checkbox'][name='chk_all']\").prop(\"checked\", false);\r\n\r\n        table = tableEl.DataTable({\r\n            language: myApp.datatablesLang,\r\n            \"destroy\": true,\r\n            \"paging\": true,\r\n            \"lengthChange\": false,\r\n            \"searching\": false,\r\n            \"ordering\": false,\r\n            \"info\": true,\r\n            \"autoWidth\": false,\r\n            \"serverSide\": true,\r\n            \"ajax\": function (data, callback, settings) {\r\n\r\n                $.ajax({\r\n                    type: \"post\",\r\n                    cache: false,\r\n                    data: data,\r\n                    url: \"list\",\r\n                    success: function (res) {\r\n                        var result = $.parseJSON(res);\r\n                        if (result.code == 0) {\r\n                            callback(result);\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n            \"columns\": [\r\n                {\r\n                    \"class\": 'td-checkbox',\r\n                    \"orderable\": false,\r\n                    \"data\": null,\r\n                    \"defaultContent\": '<input type=\"checkbox\" name=\"chk_item\"\"/>'\r\n                },\r\n                {\"data\": \"userId\"},\r\n                {\"data\": \"name\"},\r\n                {\"data\": \"userCode\"},\r\n                {\r\n                    \"data\": \"bank\",\r\n                    \"render\": function (data, type, full, meta) {\r\n                        return data ? data.bankName : '';\r\n                    }\r\n                },\r\n                {\"data\": \"roleName\"},\r\n                {\"data\": \"createTime\"}\r\n            ]\r\n        });\r\n    }\r\n\r\n    reloadTable();\r\n\r\n    tableEl.on(\"change\", \"input[type='checkbox'][name='chk_all']\", function () {\r\n        $(\"input[type='checkbox'][name='chk_item']\").prop(\"checked\", $(this).is(':checked'));\r\n    });\r\n    tableEl.on(\"change\", \"input[type='checkbox'][name='chk_item']\", function () {\r\n        var allChecked = $(\"input[type='checkbox'][name='chk_item']:not(:checked)\").length === 0;\r\n        $(\"input[type='checkbox'][name='chk_all']\").prop(\"checked\", allChecked);\r\n    });\r\n\r\n\r\n\r\n    $('#resetUser').on('click', function () {\r\n        var len = $(\"input[type='checkbox'][name='chk_item']:checked\").length;\r\n        if (len == 0) {\r\n            alert(\"请选择用户\");\r\n            return;\r\n        } else if (len > 1) {\r\n            alert(\"请选择单个用户\");\r\n            return;\r\n        } else {\r\n            $('#reset-modal .alert-success').hide();\r\n            $('#reset-modal .alert-danger').hide();\r\n            $('#reset-modal').modal();\r\n        }\r\n    });\r\n    $('#reset-modal button.btn-primary').on('click', function () {\r\n        var checkboxs = $(\"input[type='checkbox'][name='chk_item']:checked\");\r\n        if (checkboxs.length == 1) {\r\n            var data = table.row(checkboxs.parents('tr')).data();\r\n            $.ajax({\r\n                type: \"post\",\r\n                cache: false,\r\n                data: {\r\n                    userId: data.userId\r\n                },\r\n                url: \"resetPwd\",\r\n                success: function (res) {\r\n                    var result = $.parseJSON(res);\r\n                    if (result.code == 0) {\r\n                        $('#reset-modal .alert-success').text(\"重置成功\");\r\n                        $('#reset-modal .alert-success').show();\r\n\r\n                        reloadTable();\r\n                    } else {\r\n                        $('#reset-modal .alert-danger').text(\"重置失败\");\r\n                        $('#reset-modal .alert-danger').show();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n\r\n    $('#deleteUser').on('click', function () {\r\n        var len = $(\"input[type='checkbox'][name='chk_item']:checked\").length;\r\n        if (len == 0) {\r\n            alert(\"请选择用户\");\r\n            return;\r\n        } else {\r\n            $('#delete-modal .alert-success').hide();\r\n            $('#delete-modal .alert-danger').hide();\r\n            $('#delete-modal').modal();\r\n        }\r\n    });\r\n    $('#delete-modal button.btn-danger').on('click', function () {\r\n        var array = [];\r\n        $(\"input[type='checkbox'][name='chk_item']:checked\").each(function () {\r\n            var data = table.row($(this).parents('tr')).data();\r\n            array.push(data.userId);\r\n        });\r\n        if (array.length > 0) {\r\n            $.ajax({\r\n                type: \"post\",\r\n                cache: false,\r\n                traditional: true,\r\n                data: {\r\n                    userIds: array\r\n                },\r\n                url: \"delete\",\r\n                success: function (res) {\r\n                    var result = $.parseJSON(res);\r\n                    if (result.code == 0) {\r\n                        $('#delete-modal .alert-success').text(\"删除成功\");\r\n                        $('#delete-modal .alert-success').show();\r\n\r\n                        reloadTable();\r\n                    } else {\r\n                        $('#delete-modal .alert-danger').text(\"删除失败\");\r\n                        $('#delete-modal .alert-danger').show();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n});"]}